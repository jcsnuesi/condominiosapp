<div class="booking-responsive">   
     
    <p-toast />
    <p-confirmDialog />

    <p-panel header="Booking" >

        <p-fieldset id="bg-legend" legend="Choose action">
        
            <div class="radio-container">
                <div class="field-radiobutton">
                    <p-radioButton name="bookAction" value="guest" [(ngModel)]="valRadio" id="guestRadio"></p-radioButton>
                    <label for="guestRadio">Annouce a guest</label>
                </div>
                <div class="field-radiobutton">
                    <p-radioButton name="bookAction"  value="bookingAct" [(ngModel)]="valRadio" id="bookingRadio"></p-radioButton>
                    <label for="bookingRadio">Make a booking</label>
                </div>
            </div>
        
        </p-fieldset>

        <div class="show-form" *ngIf="valRadio == 'guest'">
            <form #guestForm="ngForm" *appHasPermissions="'owner'" >         
    
                <div class="guest-info">    
                    <div class="form-group">
                        <label for="condo-label">Choose condo:</label>
                        <p-dropdown #condoOption="ngModel" name="condoOption" (onChange)="getAreaInfo($event)" id="areas-available-label"
                            [options]="condoOptions" [(ngModel)]="guestInfo.condoId" optionLabel="label" placeholder="Areas available"
                            required />
                    </div>

                        <div class="form-group">
                            <label for="unitOption-labels">Choose unit:</label>
                            <p-dropdown id="unitOption-labels" #unitOptionsg="ngModel" name="unitOptionsg" [options]="unitOption"
                                [(ngModel)]="guestInfo.unit" optionLabel="label" [disabled]="unitOption.length == 0" required />
                        </div>

    
                    <div class="form-group">
                        <label for="guest-label">Guest fullname:</label>
                        <input type="text" pInputText #guestName="ngModel" name="guestName" id="guest-label" [(ngModel)]="guestInfo.fullname" required/>
    
                        <span *ngIf="guestName.touched && guestName.invalid" class="p-error">This field is required.</span>
                    </div>
                 
                    <div class="form-group">
                        <label for="phone-label">Phone:</label>
                        <input type="text" pInputText #phone="ngModel" name="phone" id="phone-label" [(ngModel)]="guestInfo.phone"
                        maxlength="11" required/>
    
                        <span *ngIf="phone.touched && phone.invalid" class="p-error">This field is required.</span>
                    </div>
                 
            
                    <div class="form-group">
                        <label for="notify-label">Choose notification method (optional):</label>
                        <p-dropdown #notifyOptions="ngModel" name="notifyOptions" id="notify-label"
                            [options]="notifingOptions" [(ngModel)]="guestInfo.notifingType" optionLabel="label" placeholder="Areas available" />
                        <span *ngIf="notifyOptions.touched && notifyOptions.invalid" class="p-error">This field is required.</span>
                    </div>
    
                    <div class="form-group"  *ngIf="guestInfo.notifingType.length != 0 && guestInfo.notifingType.label != 'None'">
                        <label for="type-notyfication-label">Type {{guestInfo.notifingType.label}}:</label>
                        <input type="text" pInputText 
                        #typeNotification="ngModel" 
                        name="typeNotification" id="type-notyfication-label"
                            [(ngModel)]="guestInfo.notifing"                         
                            />                
                            
                        <span *ngIf="typeNotification.touched && typeNotification.invalid" class="p-error">This field is required.</span>
                    </div>
    
                    <div class="form-group">
                        <label for="arrive-label">Choose arrival date:</label>
                       
                        <p-calendar id="arrive-label" 
                        #dateArrival="ngModel" 
                        name="dateArrival" 
                        inputId="calendar-12h" 
                        [(ngModel)]="guestInfo.checkIn"
                        [showTime]="true"                    
                        [hourFormat]="12" 
                        dateFormat="mm-dd-yy"
                            required />
                        <span *ngIf="dateArrival.touched && dateArrival.invalid" class="p-error">This field is required.</span>
                                          
                    </div>

                    <div class="form-group">
                        <label for="comment-label">Comment (optional):</label>
                      
                            <textarea rows="5" 
                            cols="30" 
                            pInputTextarea 
                              #comment="ngModel" 
                              name="comment" 
                              id="comment-label" 
                              [(ngModel)]="guestInfo.comments" >
                            </textarea>
                    
                        <span *ngIf="comment.touched && comment.invalid" class="p-error">This field is required.</span>
                    </div>
    
                </div>
                <div class="btn-submit">
                    <p-button type="submit" (click)="submit(guestForm)" label="Submit Guest" icon="pi pi-check" [disabled]="guestForm.invalid" />
    
                </div>
            </form>
   

        </div>
        <div class="show-form" *ngIf="valRadio == 'bookingAct'">             
            <form #bookingForm="ngForm" *appHasPermissions="'owner'">
                
                    <div class="guest-info">

                        <div class="form-group">

                            <label for="condo-label">Choose condominium:</label>
                            
                            <p-dropdown #condoOption="ngModel" name="condoOption"
                            id="condo-label" 
                            (onChange)="getAreaInfo($event)" 
                            id="areas-available-label"
                            [options]="condoOptions" 
                            [(ngModel)]="bookingInfo.condoId" 
                            optionLabel="label" 
                            placeholder="Areas available"
                                required />
                        </div>
                       
                        
                    <div class="form-group">
                        <label for="unitOption-label">Choose unit:</label>
                        <p-dropdown                         
                        id="unitOption-label" 
                        #unitOptions="ngModel" 
                        name="unitOptions" 
                        [options]="unitOption"
                            [(ngModel)]="bookingInfo.unit" 
                            optionLabel="label"
                             [disabled]="unitOption.length == 0"
                             required
                           />
                    </div>

                    <div class="form-group">
                        <label for="areaOption-label">Choose area:</label>
                        <p-dropdown #areaOption="ngModel" name="areaOption" id="areaOption-label" [options]="areaOptions"
                            [(ngModel)]="bookingInfo.areaId" optionLabel="label" placeholder="Areas available"
                            [disabled]="areaOptions.length == 0" />
                    </div>
                
                      
                    <div class="form-group">
                        <label for="checkIn-label">Check In (date/time):</label>
                        <p-calendar #checkIn="ngModel" id="checkIn-label" name="checkIn" inputId="calendar-12h" [(ngModel)]="bookingInfo.checkIn"
                            [showTime]="true" (ngModelChange)="validateDates(bookingForm)" [hourFormat]="12" dateFormat="mm-dd-yy"
                            required />
                        <span *ngIf="checkIn.touched && checkIn.invalid" class="p-error">This field is required.</span>
                    
                    </div>
                      
                    <div class="form-group">
                        <label for="checkOut-label">Expire date: (date/time):</label>
                        <p-calendar #checkOut="ngModel" name="checkOut" id="checkOut-label" inputId="calendar-12h" [(ngModel)]="bookingInfo.checkOut"
                            [showTime]="true" (ngModelChange)="validateDates(bookingForm)" [hourFormat]="12" dateFormat="mm-dd-yy"
                            required />
                    
                        <span *ngIf="checkOut.touched && checkOut.invalid" class="p-error">This field is required.</span>
                    </div>

                    <div class="form-group">
                        <label for="checkOut-label">Visitors' qtys:</label>
                        <p-inputNumber
                        #visitors="ngModel"
                        name="visitors" 
                        [(ngModel)]="bookingInfo.visitorNumber" 
                         mode="decimal" 
                        inputId="withoutgrouping" 
                        [useGrouping]="false"  
                        [min]="0"
                        [max]="10" />
                    </div>
                
                
                    </div>
             
                    <div class="p-error" *ngIf="checkOutMgs">{{checkOutMgs}}
                    </div>
                    <hr>
                    <div class="btn-submit">    
                        <p-button styleClass="center-btn"  (click)="submit(bookingForm)"  label="Book" icon="pi pi-check" [disabled]="bookingForm.invalid" />                            
                    </div>
                         
              
                    
            </form>

        </div>
    </p-panel>

</div>

<p-panel header="Booking History">
    <div class="tbl-reservations">
    
        <p-table #dt [value]="bookingHistory" 
        [(selection)]="selectedRow" dataKey="id" 
        [rowHover]="true" 
        [rows]="10"
            [showCurrentPageReport]="true" 
            [rowsPerPageOptions]="[10, 25, 50]" 
            [loading]="loading" 
            [paginator]="true"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [filterDelay]="0"
            [globalFilterFields]="['condoName', 'unit', 'area','checkIn','checkOut', 'status','verified']">
            <ng-template pTemplate="caption">
                <div class="flex justify-content-between">
                    <p-button [outlined]="true" icon="pi pi-filter-slash" label="Clear" (onClick)="clear(dt)" />
                    <p-iconField iconPosition="left">
                        <p-inputIcon>
                            <i class="pi pi-search"></i>
                        </p-inputIcon>
                        <input pInputText type="text" [(ngModel)]="searchValue"
                            (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Keyboard Search" />
                    </p-iconField>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 4rem">
                        <p-tableHeaderCheckbox />
                    </th>
                    <th pSortableColumn="condoName" style="min-width: 14rem">
                        <div class="flex justify-content-between align-items-center">
                            Condo name
                            <p-sortIcon field="condoName" />
                            <p-columnFilter type="text" field="condoName" display="menu" class="ml-auto" />
                        </div>
                    </th>
                    <th pSortableColumn="unit" style="min-width: 14rem">
                        <div class="flex justify-content-between align-items-center">
                            Unit
                            <p-sortIcon field="unit" />
                            <p-columnFilter type="text" field="unit" display="menu" class="ml-auto" />
                        </div>
                    </th>
                    <th pSortableColumn="area" style="min-width: 14rem">
                        <div class="flex justify-content-between align-items-center">
                            Area
                            <p-sortIcon field="area" />
                            <p-columnFilter type="text" field="area" display="menu" class="ml-auto" />
                        </div>
                    </th>
                
                    
                    <th pSortableColumn="date" style="min-width: 10rem">
                        <div class="flex justify-content-between align-items-center">
                            Date
                            <p-sortIcon field="checkIn" />
                            <p-columnFilter type="date" field="checkIn" display="menu" class="ml-auto" />
                        </div>
                    </th>
                    <th pSortableColumn="date" style="min-width: 10rem">
                        <div class="flex justify-content-between align-items-center">
                            Date
                            <p-sortIcon field="date" />
                            <p-columnFilter type="date" field="checkOut" display="menu" class="ml-auto" />
                        </div>
                    </th>
             
                    
                    <th pSortableColumn="status" style="min-width: 10rem">
                        <div class="flex justify-content-between align-items-center">
                            Status
                            <p-sortIcon field="status" />
                            <p-columnFilter field="status" matchMode="equals" display="menu" class="ml-auto">
                                <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                    <p-dropdown [ngModel]="value" [options]="headerStatus" (onChange)="filter($event.value)"
                                        placeholder="Any">
                                        <ng-template let-option pTemplate="item">
                                            <p-tag [value]="option.label" [severity]="getSeverity(option.label)" />
                                        </ng-template>
                                    </p-dropdown>
                                </ng-template>
                            </p-columnFilter>
                        </div>
                    </th>
                    <th pSortableColumn="area" style="width:12%">
                        <div class="flex justify-content-between align-items-center">
                            Verified
                            <p-sortIcon field="area" />
                         
                            <p-columnFilter type="boolean" field="verified"  class="ml-auto" />
                        </div>
                    </th>
         
                    <th style="width: 5rem"></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-customer>
                <tr class="p-selectable-row">
                    <td>
                        <p-tableCheckbox [value]="customer" />
                    </td>
                    <td>
                        <span class="p-column-title">Condo name</span>
                        {{ customer.condoName | titlecase }}
                    </td>
                    <td>
                        <span class="p-column-title">Unit</span>
                        {{ customer.unit }}
                    </td>
                    <td>
                        <span class="p-column-title">Area</span>
                        {{ customer.area | titlecase}}
                    </td>
                    <td>
                        <span class="p-column-title">Check in date</span>
                        {{ customer.checkIn }}
                    </td>
                    <td>
                        <span class="p-column-title">Check out date</span>
                        {{ customer.checkOut }}
                    </td>     
              
                    <td>
                        <span class="p-column-title">Status</span>
                        <p-tag [value]="customer.status" [severity]="getSeverity(customer.status)" />
                    </td>
                    <td>
                        <i class="pi"
                            [ngClass]="{ 'text-green-500 pi-check-circle': customer.verified, 'text-red-500 pi-times-circle': !customer.verified }"></i>
                    </td>
                    <td style="text-align: center">
                        <p-button severity="secondary" (click)="showDialog(customer)" icon="pi pi-cog" />
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="8">No customers found.</td>
                </tr>
            </ng-template>
        </p-table>
     
    </div>
</p-panel>

<p-dialog header="Header" [modal]="true" [(visible)]="visibleDialog" [style]="{ width: '50rem' }"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [maximizable]="true">
    <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit...
    </p>
</p-dialog>