<p-toast />
<p-confirmDialog></p-confirmDialog>
<p-messages
    [(value)]="propertyInactive"
    [enableService]="false"
    [closable]="false"
/>
<div class="grid">
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3">
                        Balance
                    </span>
                    <div class="text-900 font-medium text-2xl">
                        {{ invoiceCards.totalBalance | currency : "USD" }}
                    </div>
                </div>
                <div
                    class="cursor-pointer change-icon flex align-items-center justify-content-center bg-green-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                    (click)="showComponent('invoice')"
                >
                    <i class="pi pi-money-bill text-green-500 text-xl"></i>
                </div>
            </div>
            <span class="text-green-500 font-medium"
                >{{ invoiceCards.counts }}
            </span>
            <span class="text-500">pending</span>
        </div>
    </div>

    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3">
                        Total units
                    </span>
                    <div class="text-900 font-medium text-2xl">
                        {{ totalUnits }}
                    </div>
                </div>

                <div
                    class="flex align-items-center justify-content-center bg-blue-100 border-round icon-plus-changer"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                >
                    <i class="pi pi-home text-blue-500 text-xl"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3">
                        Booking
                    </span>
                    <div class="text-900 font-medium text-2xl">
                        {{ totalBooked }}
                    </div>
                </div>

                <a
                    (click)="showComponent('booking')"
                    class="change-icon flex align-items-center justify-content-center bg-orange-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                >
                    <i class="pi pi-calendar-minus text-orange-500 text-xl"></i>
                </a>
            </div>
            <span class="text-green-500 font-medium"
                >{{ bookingExpiring }}
            </span>
            <span class="text-500">expire today</span>
        </div>
    </div>

    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3">Staff</span>
                    <div class="text-900 font-medium text-2xl">
                        {{ totalStaff }}
                    </div>
                </div>

                <a
                    (click)="showComponent('staff')"
                    class="change-icon flex align-items-center justify-content-center bg-cyan-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                >
                    <i class="pi pi-users text-cyan-500 text-xl"></i>
                </a>
            </div>
            <!-- <span class="text-green-500 font-medium">520 </span>
            <span class="text-500">newly registered</span> -->
        </div>
    </div>
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3"
                        >Inquiries</span
                    >
                    <div class="text-900 font-medium text-2xl">
                        {{ totalInquiries }}
                    </div>
                </div>
                <div
                    class="flex align-items-center justify-content-center bg-purple-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                >
                    <a
                        (click)="showComponent('inquiry')"
                        class="flex align-items-center justify-content-center bg-purple-100 border-round change-icon"
                        [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                    >
                        <i class="pi pi-comment text-purple-500 text-xl"></i>
                    </a>
                </div>
            </div>
            <span class="text-green-500 font-medium">85 </span>
            <span class="text-500">responded</span>
        </div>
    </div>
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3"
                        >Documents</span
                    >
                    <div class="text-900 font-medium text-2xl">
                        {{ totalDocuments }}
                    </div>
                </div>
                <div
                    class="flex align-items-center justify-content-center bg-grey-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                >
                    <a
                        (click)="showComponent('documents')"
                        class="flex align-items-center justify-content-center bg-yellow-100 border-round change-icon"
                        [ngStyle]="{ width: '2.5rem', height: '2.5rem' }"
                    >
                        <i class="pi pi-folder text-orange-500 text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<p-breadcrumb class="max-w-full mb-4" [model]="itemsx" />
<div class="grid mt-2" *ngIf="componentsToShow.main">
    <div class="col-12 xl:col-6">
        <div class="card">
            <h5>Notifications</h5>
            <hr />
            <div *ngIf="!areThereInquiries">
                <p>No inquiries found.</p>
            </div>
            <div class="notifications">
                <div
                    class="notification-item"
                    *ngFor="let inquiry of inquiries"
                >
                    <div class="notification-icon">
                        <i
                            class="pi pi-comment"
                            [ngClass]="{
                                'text-red-500':
                                    inquiry.status === 'high' ||
                                    inquiry.status === 'urgent',
                                'text-yellow-500': inquiry.status === 'medium',
                                'text-green-500': inquiry.status === 'low'
                            }"
                        ></i>
                        {{ inquiry.title }}
                    </div>
                    <div class="notification-content">
                        <div class="body-notification">
                            <span class="notification-text">
                                {{ inquiry.fullname }} has sent an inquiry.
                            </span>
                            <span
                                class="notification-status"
                                [ngClass]="{
                                    'status-high': inquiry.status === 'high',
                                    'status-medium':
                                        inquiry.status === 'medium',
                                    'status-low': inquiry.status === 'low'
                                }"
                                >{{ inquiry.status | titlecase }}</span
                            >
                        </div>
                        <p-button
                            icon="pi pi-eye"
                            [rounded]="true"
                            [text]="true"
                            (click)="showInquiryDialog(inquiry)"
                        ></p-button>
                    </div>
                    <hr />
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 xl:col-6">
        <div class="card">
            <h5>Monthly Payments Stats</h5>
            <p-chart
                type="bar"
                *appHasPermissions="['admin', 'staff_admin', 'staff']"
                [data]="data"
                [options]="options"
            ></p-chart>
            <p-chart
                type="bar"
                *appHasPermissions="['owner']"
                [data]="dataOwner"
                [options]="options"
            ></p-chart>
        </div>
    </div>
</div>

<!-- Owner permissions -->
<p-dialog
    [(visible)]="visibleCreateOwnerUnit"
    [modal]="true"
    [maximizable]="true"
>
    <ng-template pTemplate="header">
        <span class="font-semibold text-xl w-100">
            <h2>Authorized users</h2>
        </span>
        <hr />
    </ng-template>

    <app-family-area *ngIf="visibleCreateOwnerUnit"></app-family-area>
</p-dialog>

<!-- Bookings generater -->
<app-booking-area
    [condoId]="units_ownerId"
    *ngIf="componentsToShow.booking"
></app-booking-area>
<!-- Invoice history -->
<app-invoice-history
    [ownerId]="condoId"
    *ngIf="componentsToShow.invoice"
></app-invoice-history>

<!-- Staff  -->
<app-staff
    *ngIf="componentsToShow.staff"
    [condoId]="condoId"
    (staffCard)="totalStaff = $event"
></app-staff>

<!-- Notification -->

<app-inquiry
    *ngIf="componentsToShow.inquiry"
    [condoId]="condoId"
    [isHome]="false"
    [dataDialog]="inquiryDialogData"
></app-inquiry>

<!-- Documents -->
<app-docs
    *ngIf="componentsToShow.documents"
    [isDashboard]="true"
    [dataDocs]="documentsData"
    [userId]="getId()"
></app-docs>
